import { prisma } from '../config/database.js';
import type { User } from '../types/User.js';
import bcrypt from 'bcrypt';

// Remove the id property from the User type since it is auto-generated by Prisma
type RegisterUserData = Omit<User, 'id'>;

// Create a new user
const createUser = async (user: RegisterUserData) => {
    // Hash the password
    const hashedPassword = await bcrypt.hash(user.password, 10);

    return await prisma.user.create({
        data: {
            firstName: user.firstName,
            lastName: user.lastName,
            email: user.email,
            confirmPassword: user.confirmPassword,
            password: hashedPassword, // Store the hashed password in the database
        },
        select: {
            id: true,
            firstName: true,
            lastName: true,
            email: true,
            password: false, // Do not return the password in the response
            confirmPassword: false,
            createdAt: true,
            updatedAt: true,
        },
    });
};

export default {
    createUser,
};